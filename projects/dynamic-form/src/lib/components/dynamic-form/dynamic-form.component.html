<form [formGroup]="form" class="dynamic-form-container">
  @for (field of config(); track field.key) { @if (field.visible !== false) { @if
  (getFieldComponent(field.controlType); as fieldComponent) {
  <div [class]="'form-field-wrapper ' + (field.styleClass || '')">
    <!-- Dynamically render the correct field component -->
    <ng-container
      [ngComponentOutlet]="fieldComponent"
      [ngComponentOutletInputs]="{ form: form, field: field }"
    />

    @if (field.hint && field.controlType !== 'divider') {
    <small class="hint-text">{{ field.hint }}</small>
    }

    <!-- Reusable error display component - apenas para campos que não são divider -->
    @if (field.controlType !== 'divider') {
    <vp-form-field-error [control]="getControl(field.key)" />
    }
  </div>
  } @else {
  <div class="form-field-wrapper">
    <small class="p-error">Tipo de campo '{{ field.controlType }}' não encontrado.</small>
  </div>
  } } }
</form>
